#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const exec_1 = require("@naturalcycles/nodejs-lib/dist/exec");
const script_1 = require("@naturalcycles/nodejs-lib/dist/script");
const paths_cnst_1 = require("../cnst/paths.cnst");
const git_util_1 = require("../util/git.util");
(0, script_1.runScript)(async () => {
    const editMsg = process.argv[process.argv.length - 1] || '.git/COMMIT_EDITMSG';
    console.log(editMsg);
    const cwd = process.cwd();
    const localConfig = `${cwd}/commitlint.config.js`;
    const sharedConfig = `${paths_cnst_1.cfgDir}/commitlint.config.js`;
    const config = fs.existsSync(localConfig) ? localConfig : sharedConfig;
    const env = { GIT_BRANCH: await (0, git_util_1.gitCurrentBranchName)() };
    await (0, exec_1.execWithArgs)(`commitlint`, [`--edit`, editMsg, `--config`, config], { env });
});
