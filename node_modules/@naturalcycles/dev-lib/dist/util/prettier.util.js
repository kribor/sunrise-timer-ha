"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.runPrettier = void 0;
const fs = require("fs");
const exec_1 = require("@naturalcycles/nodejs-lib/dist/exec");
const paths_cnst_1 = require("../cnst/paths.cnst");
const { prettierDirs, prettierExtensionsAll, lintExclude } = require('../../cfg/_cnst');
const prettierPaths = [
    // Everything inside these folders
    `./{${prettierDirs}}/**/*.{${prettierExtensionsAll}}`,
    // Root
    `./*.{${prettierExtensionsAll}}`,
    // Exclude
    ...lintExclude.map((s) => `!${s}`),
];
async function runPrettier() {
    // If there's no `prettier.config.js` in target project - pass `./cfg/prettier.config.js`
    const prettierConfigPath = [`./prettier.config.js`].find(f => fs.existsSync(f)) || `${paths_cnst_1.cfgDir}/prettier.config.js`;
    // prettier --write 'src/**/*.{js,ts,css,scss,graphql}'
    const args = [`--write`, `--config`, prettierConfigPath, ...prettierPaths];
    await (0, exec_1.execWithArgs)('prettier', args);
}
exports.runPrettier = runPrettier;
