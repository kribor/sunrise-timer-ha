"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.readableMap = void 0;
const index_1 = require("../../index");
function readableMap(readable, mapper) {
    const out = (0, index_1.readableCreate)();
    void (async () => {
        try {
            let index = 0;
            for await (const item of readable) {
                const v = await mapper(item, index++);
                out.push(v);
            }
            // We're done
            out.push(null);
        }
        catch (err) {
            console.error(err);
            out.emit('error', err);
        }
    })();
    return out;
}
exports.readableMap = readableMap;
